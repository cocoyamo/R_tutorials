<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Data Visualization | Hello and welcome to our RStudio journey!</title>
  <meta name="description" content="This is a RStudio tutorial." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Data Visualization | Hello and welcome to our RStudio journey!" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a RStudio tutorial." />
  <meta name="github-repo" content="cocoyamo/R_tutorials" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Data Visualization | Hello and welcome to our RStudio journey!" />
  
  <meta name="twitter:description" content="This is a RStudio tutorial." />
  

<meta name="author" content="Moya" />


<meta name="date" content="2024-11-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-analysis.html"/>
<link rel="next" href="data-export.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Welcome!</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="rstudio-environment-and-installation.html"><a href="rstudio-environment-and-installation.html"><i class="fa fa-check"></i><b>2</b> RStudio Environment and Installation</a></li>
<li class="chapter" data-level="3" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html"><i class="fa fa-check"></i><b>3</b> Data Import and Reading</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html#import-your-data"><i class="fa fa-check"></i><b>3.1</b> Import Your Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html#weather-math-data-explanation"><i class="fa fa-check"></i><b>3.1.1</b> Weather Math Data Explanation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html#dataset-packages"><i class="fa fa-check"></i><b>3.2</b> Dataset packages</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html#babynames"><i class="fa fa-check"></i><b>3.2.1</b> babynames</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html#starwars"><i class="fa fa-check"></i><b>3.2.2</b> starwars</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-import-and-reading.html"><a href="data-import-and-reading.html#ways-to-check-data"><i class="fa fa-check"></i><b>3.3</b> Ways to Check Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="overview-of-tidyverse-and-core-functions.html"><a href="overview-of-tidyverse-and-core-functions.html"><i class="fa fa-check"></i><b>4</b> Overview of Tidyverse and Core Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="overview-of-tidyverse-and-core-functions.html"><a href="overview-of-tidyverse-and-core-functions.html#pipe-example"><i class="fa fa-check"></i><b>4.1</b> pipe example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-cleaning-and-transformation.html"><a href="data-cleaning-and-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Cleaning and Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-cleaning-and-transformation.html"><a href="data-cleaning-and-transformation.html#select-filter-mutate"><i class="fa fa-check"></i><b>5.1</b> select(), filter(), &amp; mutate()</a></li>
<li class="chapter" data-level="5.2" data-path="data-cleaning-and-transformation.html"><a href="data-cleaning-and-transformation.html#dealing-with-omission"><i class="fa fa-check"></i><b>5.2</b> dealing with omission</a></li>
<li class="chapter" data-level="5.3" data-path="data-cleaning-and-transformation.html"><a href="data-cleaning-and-transformation.html#change-column-names"><i class="fa fa-check"></i><b>5.3</b> change column names</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-wrangling-and-reshaping.html"><a href="data-wrangling-and-reshaping.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling and Reshaping</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-wrangling-and-reshaping.html"><a href="data-wrangling-and-reshaping.html#pivot"><i class="fa fa-check"></i><b>6.1</b> pivot</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-wrangling-and-reshaping.html"><a href="data-wrangling-and-reshaping.html#example-converting-wide-to-long-format"><i class="fa fa-check"></i><b>6.1.1</b> example: converting wide to long format</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-wrangling-and-reshaping.html"><a href="data-wrangling-and-reshaping.html#join"><i class="fa fa-check"></i><b>6.2</b> join</a></li>
<li class="chapter" data-level="6.3" data-path="data-wrangling-and-reshaping.html"><a href="data-wrangling-and-reshaping.html#bind"><i class="fa fa-check"></i><b>6.3</b> bind</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-analysis.html"><a href="statistical-analysis.html"><i class="fa fa-check"></i><b>7</b> Statistical Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-analysis.html"><a href="statistical-analysis.html#t-test"><i class="fa fa-check"></i><b>7.1</b> t-test</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="statistical-analysis.html"><a href="statistical-analysis.html#example-independent-t-test"><i class="fa fa-check"></i><b>7.1.1</b> example: Independent t-test</a></li>
<li class="chapter" data-level="7.1.2" data-path="statistical-analysis.html"><a href="statistical-analysis.html#example-paired-t-test"><i class="fa fa-check"></i><b>7.1.2</b> example: Paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="statistical-analysis.html"><a href="statistical-analysis.html#anova"><i class="fa fa-check"></i><b>7.2</b> ANOVA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-analysis.html"><a href="statistical-analysis.html#one-way-anova"><i class="fa fa-check"></i><b>7.2.1</b> one-way ANOVA</a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-analysis.html"><a href="statistical-analysis.html#two-way-anova"><i class="fa fa-check"></i><b>7.2.2</b> two-way ANOVA</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-analysis.html"><a href="statistical-analysis.html#three-way-anova"><i class="fa fa-check"></i><b>7.2.3</b> three-way ANOVA</a></li>
<li class="chapter" data-level="7.2.4" data-path="statistical-analysis.html"><a href="statistical-analysis.html#mixed-anova"><i class="fa fa-check"></i><b>7.2.4</b> mixed ANOVA</a></li>
<li class="chapter" data-level="7.2.5" data-path="statistical-analysis.html"><a href="statistical-analysis.html#additional-notes"><i class="fa fa-check"></i><b>7.2.5</b> Additional notes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistical-analysis.html"><a href="statistical-analysis.html#post-hoc-analysis"><i class="fa fa-check"></i><b>7.3</b> Post hoc analysis</a></li>
<li class="chapter" data-level="7.4" data-path="statistical-analysis.html"><a href="statistical-analysis.html#regression-analysis"><i class="fa fa-check"></i><b>7.4</b> Regression analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>8</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-visualization.html"><a href="data-visualization.html#bar-chart"><i class="fa fa-check"></i><b>8.1</b> bar chart</a></li>
<li class="chapter" data-level="8.2" data-path="data-visualization.html"><a href="data-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>8.2</b> scatter plot</a></li>
<li class="chapter" data-level="8.3" data-path="data-visualization.html"><a href="data-visualization.html#box-plot"><i class="fa fa-check"></i><b>8.3</b> box plot</a></li>
<li class="chapter" data-level="8.4" data-path="data-visualization.html"><a href="data-visualization.html#histogram"><i class="fa fa-check"></i><b>8.4</b> histogram</a></li>
<li class="chapter" data-level="8.5" data-path="data-visualization.html"><a href="data-visualization.html#density-plot"><i class="fa fa-check"></i><b>8.5</b> density plot</a></li>
<li class="chapter" data-level="8.6" data-path="data-visualization.html"><a href="data-visualization.html#violin-plot"><i class="fa fa-check"></i><b>8.6</b> violin plot</a></li>
<li class="chapter" data-level="8.7" data-path="data-visualization.html"><a href="data-visualization.html#scatterplot-matrix"><i class="fa fa-check"></i><b>8.7</b> scatterplot matrix</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="data-visualization.html"><a href="data-visualization.html#categorical-numeric"><i class="fa fa-check"></i><b>8.7.1</b> categorical * numeric</a></li>
<li class="chapter" data-level="8.7.2" data-path="data-visualization.html"><a href="data-visualization.html#numeric-numeric"><i class="fa fa-check"></i><b>8.7.2</b> numeric * numeric</a></li>
<li class="chapter" data-level="8.7.3" data-path="data-visualization.html"><a href="data-visualization.html#numeric-numeric-numeric"><i class="fa fa-check"></i><b>8.7.3</b> numeric * numeric * numeric</a></li>
<li class="chapter" data-level="8.7.4" data-path="data-visualization.html"><a href="data-visualization.html#numeric-numeric-numeric-categorical"><i class="fa fa-check"></i><b>8.7.4</b> numeric * numeric * numeric * categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="data-visualization.html"><a href="data-visualization.html#additional-features-on-the-plot"><i class="fa fa-check"></i><b>8.8</b> additional features on the plot</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="data-visualization.html"><a href="data-visualization.html#labels"><i class="fa fa-check"></i><b>8.8.1</b> labels</a></li>
<li class="chapter" data-level="8.8.2" data-path="data-visualization.html"><a href="data-visualization.html#colors"><i class="fa fa-check"></i><b>8.8.2</b> colors</a></li>
<li class="chapter" data-level="8.8.3" data-path="data-visualization.html"><a href="data-visualization.html#scales"><i class="fa fa-check"></i><b>8.8.3</b> scales</a></li>
<li class="chapter" data-level="8.8.4" data-path="data-visualization.html"><a href="data-visualization.html#themes"><i class="fa fa-check"></i><b>8.8.4</b> themes</a></li>
<li class="chapter" data-level="8.8.5" data-path="data-visualization.html"><a href="data-visualization.html#significance-levels"><i class="fa fa-check"></i><b>8.8.5</b> significance levels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-export.html"><a href="data-export.html"><i class="fa fa-check"></i><b>9</b> Data Export</a></li>
<li class="chapter" data-level="10" data-path="conclusion-and-advanced-learning.html"><a href="conclusion-and-advanced-learning.html"><i class="fa fa-check"></i><b>10</b> Conclusion and Advanced Learning</a></li>
<li class="divider"></li>
<li><a href="https://github.com/cocoyamo/R_tutorials" target="blank">Check out cocoya's GitHub Repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hello and welcome to our RStudio journey!</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Data Visualization<a href="data-visualization.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="bar-chart" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> bar chart<a href="data-visualization.html#bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s use a new dataset as an example here. In the <code>lego_sample</code> dataset, there are various LEGO sets, pieces, recommended retail prices, prices on Amazon, sizes, and more.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="data-visualization.html#cb134-1" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb134-2"><a href="data-visualization.html#cb134-2" tabindex="-1"></a>lego_sample</span></code></pre></div>
<pre><code>## # A tibble: 75 × 14
##    item_number set_name     theme pieces  price amazon_price  year ages  pages minifigures packaging weight
##          &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; 
##  1       10859 My First La… DUPL…      6   4.99        16     2018 Ages…     9          NA Box       &lt;NA&gt;  
##  2       10860 My First Ra… DUPL…      6   4.99         9.45  2018 Ages…     9          NA Box       0.13K…
##  3       10862 My First Ce… DUPL…     41  15.0         39.9   2018 Ages…     9          NA Box       &lt;NA&gt;  
##  4       10864 Large Playg… DUPL…     71  50.0         56.7   2018 Ages…    32           2 Plastic … 1.41K…
##  5       10867 Farmers&#39; Ma… DUPL…     26  20.0         37.0   2018 Ages…     9           3 Box       &lt;NA&gt;  
##  6       10870 Farm Animals DUPL…     16   9.99         9.99  2018 Ages…     8          NA Box       &lt;NA&gt;  
##  7       10872 Train Bridg… DUPL…     26  25.0         22.0   2018 Ages…    16           1 Box       0.88K…
##  8       10875 Cargo Train  DUPL…    105 120.         129.    2018 Ages…    64           3 Box       2.86K…
##  9       10876 Spider-Man … DUPL…     38  30.0         74.5   2018 Ages…    20           3 Box       0.54K…
## 10       10878 Rapunzel&#39;s … DUPL…     37  30.0         99.0   2018 Ages…    24           1 Box       &lt;NA&gt;  
## # ℹ 65 more rows
## # ℹ 2 more variables: unique_pieces &lt;dbl&gt;, size &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="data-visualization.html#cb136-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb136-2"><a href="data-visualization.html#cb136-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb136-3"><a href="data-visualization.html#cb136-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> packaging, <span class="at">y =</span> pieces)) <span class="sc">+</span></span>
<span id="cb136-4"><a href="data-visualization.html#cb136-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">7</span>, <span class="at">fill =</span> <span class="st">&quot;#BDD5EA&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-5"><a href="data-visualization.html#cb136-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">width =</span> .<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb136-6"><a href="data-visualization.html#cb136-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(theme <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-184-1.png" width="672" /></p>
<p>It seems that a lot has happened in the code chunk, and there’s quite a bit of information presented by the graphs.</p>
<p>Let’s walk through the code.</p>
<ul>
<li><p>in <code>ggplot()</code>, we specify the <code>x</code> and <code>y</code> axes.</p></li>
<li><p><code>geom_bar()</code> creates the bar chart.</p>
<ul>
<li><p><code>stat = "summary"</code> calculates the mean value of the y-axis variable, which is <code>pieces</code> in this case.</p></li>
<li><p><code>position = position_dodge()</code> separates the bars to avoid overlap.</p></li>
<li><p><code>width =</code> sets the width of the bars. If <code>width = 1</code>, the bars will stick together.</p></li>
<li><p><code>fill =</code> can be a single color (as in this example) or another variable to create color variation.</p></li>
</ul></li>
<li><p><code>geom_errorbar()</code> calculates and displays the standard error on the graph.</p>
<ul>
<li>The <code>width</code>, <code>fill</code>, and <code>position</code> arguments work similarly to those in <code>geom_bar()</code>.</li>
</ul></li>
<li><p><code>facet_wrap()</code> separates the graphs by the variable you specify.</p>
<ul>
<li><p>You can use <code>&lt;your variable&gt; ~ .</code> or <code>~ &lt;your variable&gt;</code>.</p></li>
<li><p>The <code>scales = "free"</code> option adjusts the y-axis for each graph based on its data. However, it’s not always recommended, as explained below.</p></li>
</ul></li>
</ul>
<p>Now, let’s analyze the graph. We can observe a few things:</p>
<ol style="list-style-type: decimal">
<li><p>The graphs are separated by different LEGO themes: “DUPLO®”, “Friends”, and “City”.</p></li>
<li><p>In the “Friends” and “City” collections, there are only data from the Box packaging method, indicating that there is no data where the LEGO is from “City” or “Friends” collections using Plastic box.</p></li>
<li><p>The y-axis scales differ across the graphs. Although the program automatically adjusts the scale based on the data, this might hinder important information. For example, in the “City” and “Friends” collections, the difference in pieces is harder to discern. We will explain how to address this in the <strong>scales</strong> section.</p></li>
</ol>
<p>If we do not want to use <code>facet_wrap()</code> for separating graphs, we can use other ways to distinguish between categories. For exapmle, if we assign a variable to <code>fill =</code>, we can ask RStudio to fill different colors for each category.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="data-visualization.html#cb137-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb137-2"><a href="data-visualization.html#cb137-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb137-3"><a href="data-visualization.html#cb137-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> packaging, <span class="at">y =</span> pieces, <span class="at">fill =</span> theme)) <span class="sc">+</span></span>
<span id="cb137-4"><a href="data-visualization.html#cb137-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb137-5"><a href="data-visualization.html#cb137-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">12</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-185-1.png" width="672" /></p>
</div>
<div id="scatter-plot" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> scatter plot<a href="data-visualization.html#scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="data-visualization.html#cb138-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb138-2"><a href="data-visualization.html#cb138-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb138-3"><a href="data-visualization.html#cb138-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pieces, <span class="at">y =</span> price, <span class="at">color =</span> theme, <span class="at">shape =</span> theme)) <span class="sc">+</span></span>
<span id="cb138-4"><a href="data-visualization.html#cb138-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-5"><a href="data-visualization.html#cb138-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-186-1.png" width="672" /></p>
<p>Let’s examine the code:</p>
<p>In the <code>aes()</code> section, I’ve used both color <strong>AND</strong> shape to differentiate by <code>theme</code>. Usually, one type of distinction is sufficient, but sometimes colors alone may be hard to differentiate. In such cases, adding another feature (e.g., shape) can improve readability.</p>
<ul>
<li><p><code>geom_point()</code> is used to display individual data point, creating the scatter plot.</p></li>
<li><p><code>geom_smooth()</code> adds trend lines to the data. By setting <code>method = "lm"</code>, we apply a linear model, which results in a straight trend line.</p></li>
</ul>
<p>Next, let’s try a different dataset: <code>movies</code>. This dataset is part of the <code>openintro</code> package and contains several datasets.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="data-visualization.html#cb139-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;openintro&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="data-visualization.html#cb140-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;openintro&quot;</span>)</span>
<span id="cb140-2"><a href="data-visualization.html#cb140-2" tabindex="-1"></a>movies</span></code></pre></div>
<pre><code>## # A tibble: 140 × 5
##    movie           genre      score rating box_office
##    &lt;chr&gt;           &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1 2Fast2Furious   action      48.9 PG-13      127.  
##  2 28DaysLater     horror      78.2 R           45.1 
##  3 AGuyThing       rom-comedy  39.5 PG-13       15.5 
##  4 AManApart       action      42.9 R           26.2 
##  5 AMightyWind     comedy      79.9 PG-13       17.8 
##  6 AgentCodyBanks  action      57.9 PG          47.8 
##  7 Alex&amp;Emma       rom-comedy  35.1 PG-13       14.2 
##  8 AmericanWedding comedy      50.7 R          104.  
##  9 AngerManagement comedy      62.6 PG-13      134.  
## 10 AnythingElse    rom-comedy  63.3 R            3.21
## # ℹ 130 more rows</code></pre>
<p>The dataset contains 5 columns and 140 rows, representing movies released in 2003. The columns include the movie title, genre, score (by critics on a scale 0-100), MPAA rating, and <code>box_office</code> (millions of dollars earned at the box office in the US and Canada.)</p>
<p>You can type <code>movies</code> in the <code>help</code> section in the bottom-right panel for a detailed description of the data.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="data-visualization.html#cb142-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span> </span>
<span id="cb142-2"><a href="data-visualization.html#cb142-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> box_office, <span class="at">y =</span> score)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb142-3"><a href="data-visualization.html#cb142-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-189-1.png" width="672" /></p>
<p>From the graph, we can see a positive relationship between the <code>box_office</code> and <code>score</code>.</p>
</div>
<div id="box-plot" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> box plot<a href="data-visualization.html#box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A box plot helps us visualize the interquartile range in our data. This is useful when comparing a categorical variable with numerical values.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="data-visualization.html#cb143-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb143-2"><a href="data-visualization.html#cb143-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> rating)) <span class="sc">+</span></span>
<span id="cb143-3"><a href="data-visualization.html#cb143-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span></code></pre></div>
<p><img src="figures/unnamed-chunk-190-1.png" width="672" /></p>
</div>
<div id="histogram" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> histogram<a href="data-visualization.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="data-visualization.html#cb144-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb144-2"><a href="data-visualization.html#cb144-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb144-3"><a href="data-visualization.html#cb144-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-191-1.png" width="672" /></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="data-visualization.html#cb145-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb145-2"><a href="data-visualization.html#cb145-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb145-3"><a href="data-visualization.html#cb145-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-192-1.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="data-visualization.html#cb146-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb146-2"><a href="data-visualization.html#cb146-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb146-3"><a href="data-visualization.html#cb146-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-193-1.png" width="672" /></p>
<ul>
<li><code>binwidth</code>: controls the thickness of the bars, if the bars are too thin (<code>binwidth = 1</code>), you’ll see individual data points clearly. However, this may not be ideal for observing general trends in the data. Therefore, I recommend experimenting with different <code>binwidth</code> values to find what works best for your data.</li>
</ul>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="data-visualization.html#cb147-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb147-2"><a href="data-visualization.html#cb147-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="data-visualization.html#cb147-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-194-1.png" width="672" /></p>
<p>In the histogram, the <code>color</code> argument controls the <strong>outline</strong> color of the bar, while <code>fill</code> controls the interior color of the bars.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="data-visualization.html#cb148-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb148-2"><a href="data-visualization.html#cb148-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">fill =</span> rating)) <span class="sc">+</span></span>
<span id="cb148-3"><a href="data-visualization.html#cb148-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-195-1.png" width="672" /></p>
</div>
<div id="density-plot" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> density plot<a href="data-visualization.html#density-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Density plots are similar to connecting the peaks of a histogram to form a smooth line, providing a clearer view of the data distribution.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="data-visualization.html#cb149-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb149-2"><a href="data-visualization.html#cb149-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb149-3"><a href="data-visualization.html#cb149-3" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-196-1.png" width="672" /></p>
<p>We can also separate data into subcategories.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="data-visualization.html#cb150-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb150-2"><a href="data-visualization.html#cb150-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb150-3"><a href="data-visualization.html#cb150-3" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="figures/unnamed-chunk-197-1.png" width="672" /></p>
<p>However, this graph might be hard to read due to overlapping data. For instance, the values for ratings <code>R</code> and <code>PG-13</code> are not clearly distinguishable. To resolve this, we can adjust the <code>transparancy</code> of the graph.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="data-visualization.html#cb151-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb151-2"><a href="data-visualization.html#cb151-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="data-visualization.html#cb151-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-198-1.png" width="672" /></p>
<p>Alternatively, we can use <code>geom_density_ridges()</code> to further separate the data, improving readability.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="data-visualization.html#cb152-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggridges&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="data-visualization.html#cb153-1" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb153-2"><a href="data-visualization.html#cb153-2" tabindex="-1"></a></span>
<span id="cb153-3"><a href="data-visualization.html#cb153-3" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb153-4"><a href="data-visualization.html#cb153-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb153-5"><a href="data-visualization.html#cb153-5" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-200-1.png" width="672" /></p>
</div>
<div id="violin-plot" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> violin plot<a href="data-visualization.html#violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <strong>violin plot</strong> is another display of density plot. The operation is also easy, just change <code>geom_density()</code> into <code>geom_violin()</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="data-visualization.html#cb154-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb154-2"><a href="data-visualization.html#cb154-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb154-3"><a href="data-visualization.html#cb154-3" tabindex="-1"></a>  <span class="fu">geom_violin</span>() </span></code></pre></div>
<p><img src="figures/unnamed-chunk-201-1.png" width="672" /></p>
<p>As usual, you can adjust the width and transparency of the violin plot using <code>width =</code> and <code>alpha =</code>, respectively.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="data-visualization.html#cb155-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb155-2"><a href="data-visualization.html#cb155-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb155-3"><a href="data-visualization.html#cb155-3" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">width =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-202-1.png" width="672" /></p>
<p>Additionally, you can add a boxplot on top of the violin plot to make the visualization more informative.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="data-visualization.html#cb156-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb156-2"><a href="data-visualization.html#cb156-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb156-3"><a href="data-visualization.html#cb156-3" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">width =</span> <span class="fl">1.1</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb156-4"><a href="data-visualization.html#cb156-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-203-1.png" width="672" /></p>
<p>One flexible feature of R graphics is that they are created <strong>layer by layer</strong>. Therefore, you can see that changing the order between <code>geom_violin()</code> and <code>geom_boxplot()</code> will affect the resulting graph.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="data-visualization.html#cb157-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb157-2"><a href="data-visualization.html#cb157-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb157-3"><a href="data-visualization.html#cb157-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb157-4"><a href="data-visualization.html#cb157-4" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">width =</span> <span class="fl">1.1</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-204-1.png" width="672" /></p>
<p>In this example, we can see that the boxplot is almost invisible, even without adjusting its transparency. This happens because moving <code>geom_violin()</code> after <code>geom_boxplot()</code> causes R to draw the boxplot first, and then add the violin plot on top. Since the violin plot is not very transparent (alpha = 0.9, almost opaque), it effectively shadows the boxplot.</p>
<blockquote>
<p>Keep in mind that in <code>ggplot()</code>, the order of layers matters.</p>
</blockquote>
</div>
<div id="scatterplot-matrix" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> scatterplot matrix<a href="data-visualization.html#scatterplot-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A scatterplot matrix generated by ggpairs visualizes pairwise relationships between multiple variables, displaying scatterplots for each pair and univariate distributions on the diagonal.</p>
<p>We will now create them using this package: <code>GGally</code>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="data-visualization.html#cb158-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;GGally&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="data-visualization.html#cb159-1" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<div id="categorical-numeric" class="section level3 hasAnchor" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> categorical * numeric<a href="data-visualization.html#categorical-numeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>這邊的資料在下面才有介紹，不知道是要把介紹提前還是怎樣：Ｄ 不知道 再看看</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="data-visualization.html#cb160-1" tabindex="-1"></a>lego_sample</span></code></pre></div>
<pre><code>## # A tibble: 75 × 14
##    item_number set_name     theme pieces  price amazon_price  year ages  pages minifigures packaging weight
##          &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; 
##  1       10859 My First La… DUPL…      6   4.99        16     2018 Ages…     9          NA Box       &lt;NA&gt;  
##  2       10860 My First Ra… DUPL…      6   4.99         9.45  2018 Ages…     9          NA Box       0.13K…
##  3       10862 My First Ce… DUPL…     41  15.0         39.9   2018 Ages…     9          NA Box       &lt;NA&gt;  
##  4       10864 Large Playg… DUPL…     71  50.0         56.7   2018 Ages…    32           2 Plastic … 1.41K…
##  5       10867 Farmers&#39; Ma… DUPL…     26  20.0         37.0   2018 Ages…     9           3 Box       &lt;NA&gt;  
##  6       10870 Farm Animals DUPL…     16   9.99         9.99  2018 Ages…     8          NA Box       &lt;NA&gt;  
##  7       10872 Train Bridg… DUPL…     26  25.0         22.0   2018 Ages…    16           1 Box       0.88K…
##  8       10875 Cargo Train  DUPL…    105 120.         129.    2018 Ages…    64           3 Box       2.86K…
##  9       10876 Spider-Man … DUPL…     38  30.0         74.5   2018 Ages…    20           3 Box       0.54K…
## 10       10878 Rapunzel&#39;s … DUPL…     37  30.0         99.0   2018 Ages…    24           1 Box       &lt;NA&gt;  
## # ℹ 65 more rows
## # ℹ 2 more variables: unique_pieces &lt;dbl&gt;, size &lt;chr&gt;</code></pre>
<p>Let’s say we want to explore the relationship between the price of Lego sets (<code>price</code>, a <strong>continuous numeric variable</strong>) and their size (<code>size</code>, a <strong>categorical variable</strong>).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="data-visualization.html#cb162-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb162-2"><a href="data-visualization.html#cb162-2" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;price&quot;</span>, <span class="st">&quot;size&quot;</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-208-1.png" width="672" /></p>
<p>The top-left panel of the resulting plot shows the distribution of the <code>price</code> – a univariate plot of <code>price</code> vs. itself. The bottom-right panel shows the distribution of <code>size</code>, where RStudio counts the number of Lego sets in each category (<code>large</code> and <code>small</code>).</p>
<p>The top-right panel presents a boxplot of <code>price</code> vss <code>size</code>, which is commonly used for visualizing the relationship between <strong>numeric variable</strong> and <strong>categorical variable</strong>. Similarly, the bottom-left panel shows the distribution of prices within each <code>size</code> category, but it doesn’t specify which data belongs to <code>large</code> or <code>small</code> categories (possibly because I’m just couldn’t figure it out yet).</p>
</div>
<div id="numeric-numeric" class="section level3 hasAnchor" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> numeric * numeric<a href="data-visualization.html#numeric-numeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, let’s examine two <strong>numerical variables</strong>: the recommended retail price (<code>price</code>) and the price on Amazon (<code>amazon_price</code>).</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="data-visualization.html#cb163-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb163-2"><a href="data-visualization.html#cb163-2" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;price&quot;</span>, <span class="st">&quot;amazon_price&quot;</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-209-1.png" width="672" /></p>
<p>This graph differs from the previous one because both variables are numeric. The top-left panel shows a density plot of the recommended retail <code>price</code>, while the bottom-right panel does the <code>amazon_price</code>. Although the distributions are similar, they are not identical.</p>
<p>In the bottom-right panel, a scatter plot shows a strong positive correlation between the two prices, as reflected by the correlation coefficient displayed in the top-right panel.</p>
</div>
<div id="numeric-numeric-numeric" class="section level3 hasAnchor" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> numeric * numeric * numeric<a href="data-visualization.html#numeric-numeric-numeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What if we add one more numeric variable? We can take a look at the relationship between <code>price</code>, <code>amazon_price</code>, and <code>minifigures</code> (after converting <code>minifigures</code> back to a numeric variable).</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="data-visualization.html#cb164-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb164-2"><a href="data-visualization.html#cb164-2" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;price&quot;</span>, <span class="st">&quot;amazon_price&quot;</span>, <span class="st">&quot;minifigures&quot;</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-210-1.png" width="672" /></p>
<p>This gives us a clearer overview of the relationship between multiple numeric variables.</p>
<p>If we want to add more information, like trend lines or confidence intervals, we can use the following code:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="data-visualization.html#cb165-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb165-2"><a href="data-visualization.html#cb165-2" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;price&quot;</span>, <span class="st">&quot;amazon_price&quot;</span>, <span class="st">&quot;minifigures&quot;</span>),</span>
<span id="cb165-3"><a href="data-visualization.html#cb165-3" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;smooth&quot;</span>)))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-211-1.png" width="672" /></p>
<p>Here, we simply add <code>lower =</code> and specify what we want.</p>
<ul>
<li><p><code>lower =</code>: Controls the display of the lower part of the graph.</p></li>
<li><p><code>wrap()</code>: Helps us to specify what we want for continuous numeric variables.</p></li>
<li><p><code>smoooth</code>: Creates trend lines on the scatter plot (similar to <code>geom_smooth</code>).</p></li>
<li><p><code>continuous =</code>: Specifies that the data is continuous, allowing us to adjust how it’s displayed.</p></li>
</ul>
<p>Note that the default correlation method is <code>"pearson"</code>. To change this, you can add the <code>mehtod =</code> argument to specify another correlation method.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="data-visualization.html#cb166-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb166-2"><a href="data-visualization.html#cb166-2" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;price&quot;</span>, <span class="st">&quot;amazon_price&quot;</span>, <span class="st">&quot;minifigures&quot;</span>),</span>
<span id="cb166-3"><a href="data-visualization.html#cb166-3" tabindex="-1"></a>          <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;cor&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)),</span>
<span id="cb166-4"><a href="data-visualization.html#cb166-4" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;smooth&quot;</span>)))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-212-1.png" width="672" /></p>
<p>For the <code>upper =</code> part of the graph:</p>
<ul>
<li><code>upper = "cor"</code>: Displays the correlation coefficients in the upper panels.</li>
</ul>
</div>
<div id="numeric-numeric-numeric-categorical" class="section level3 hasAnchor" number="8.7.4">
<h3><span class="header-section-number">8.7.4</span> numeric * numeric * numeric * categorical<a href="data-visualization.html#numeric-numeric-numeric-categorical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we’ve explore several ways to plot numeric variables, let’s add a categorical variable here. A good way to differentiate groups is by assigning colors to categories in the <code>aes()</code> function.</p>
<blockquote>
<p>you have learned a few ways to deal with plots inside <code>ggpairs()</code>. Let us add some colors on it (literally).</p>
</blockquote>
<p>Here’s an example:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="data-visualization.html#cb167-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb167-2"><a href="data-visualization.html#cb167-2" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;price&quot;</span>, <span class="st">&quot;amazon_price&quot;</span>, <span class="st">&quot;minifigures&quot;</span>, <span class="st">&quot;size&quot;</span>),</span>
<span id="cb167-3"><a href="data-visualization.html#cb167-3" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> size, <span class="at">alpha =</span> .<span class="dv">7</span>),</span>
<span id="cb167-4"><a href="data-visualization.html#cb167-4" tabindex="-1"></a>          <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;cor&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)),</span>
<span id="cb167-5"><a href="data-visualization.html#cb167-5" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;smooth&quot;</span>)))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-213-1.png" width="672" /></p>
<p>Adding transparency (<code>alpha =</code>) helps reduce clutter in the plot by making overlapping graphs easier to distinguish.</p>
<p>Below is another coding style to achieve the same result, which I prefer. It separates the column selection step from the plotting step, making the code easier to manage.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="data-visualization.html#cb168-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb168-2"><a href="data-visualization.html#cb168-2" tabindex="-1"></a>  <span class="fu">select</span>(price, amazon_price, minifigures, size) <span class="sc">|&gt;</span></span>
<span id="cb168-3"><a href="data-visualization.html#cb168-3" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> size, <span class="at">alpha =</span> .<span class="dv">7</span>),</span>
<span id="cb168-4"><a href="data-visualization.html#cb168-4" tabindex="-1"></a>          <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;cor&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)),</span>
<span id="cb168-5"><a href="data-visualization.html#cb168-5" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;smooth&quot;</span>)))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-214-1.png" width="672" /></p>
<p>Although <code>ggpairs()</code> is useful for exploring relationships between different variables (e.g., comparing test scores), it can sometimes become overwhelming with too many plots. If you’re unsure whether this approach is the best for your data, I recommend creating individual plots first (e.g., density or box plots) before mixing everything together. This will help clarify the relationships you want to explore and the most effective ways to visualize them.</p>
</div>
</div>
<div id="additional-features-on-the-plot" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> additional features on the plot<a href="data-visualization.html#additional-features-on-the-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="labels" class="section level3 hasAnchor" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> labels<a href="data-visualization.html#labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A good graph includes informative labels. While you could add titles, subtitles, and other labels in separate software after downloading the graph, it’s more efficient and reduces the chance of errors if you add all the labels directly in RStudio.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="data-visualization.html#cb169-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb169-2"><a href="data-visualization.html#cb169-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb169-3"><a href="data-visualization.html#cb169-3" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb169-4"><a href="data-visualization.html#cb169-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb169-5"><a href="data-visualization.html#cb169-5" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Movie Scores of Different MPAA Ratings.&quot;</span>,</span>
<span id="cb169-6"><a href="data-visualization.html#cb169-6" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&quot;Put your subtitle here because I don&#39;t know what to say.&quot;</span>,</span>
<span id="cb169-7"><a href="data-visualization.html#cb169-7" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Movie Score&quot;</span>,</span>
<span id="cb169-8"><a href="data-visualization.html#cb169-8" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;MPAA Rating&quot;</span>,</span>
<span id="cb169-9"><a href="data-visualization.html#cb169-9" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">&quot;Rating&quot;</span>,</span>
<span id="cb169-10"><a href="data-visualization.html#cb169-10" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;Rating&quot;</span>,</span>
<span id="cb169-11"><a href="data-visualization.html#cb169-11" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;sources: movies from openintro&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-215-1.png" width="672" /></p>
<p>If you prefer not to show certain labels, you can aslo specify this in the code and let the program remove them for you.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="data-visualization.html#cb170-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb170-2"><a href="data-visualization.html#cb170-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb170-3"><a href="data-visualization.html#cb170-3" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb170-4"><a href="data-visualization.html#cb170-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb170-5"><a href="data-visualization.html#cb170-5" tabindex="-1"></a>        <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb170-6"><a href="data-visualization.html#cb170-6" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb170-7"><a href="data-visualization.html#cb170-7" tabindex="-1"></a>        <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb170-8"><a href="data-visualization.html#cb170-8" tabindex="-1"></a>        <span class="at">fill =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-216-1.png" width="672" /></p>
<p>For example, in the code chunk above, when we set the <code>x-axis</code> to <code>NULL</code>, the label disappears from the graph. However, if we don’t specify the <code>y-axis</code> in the <code>labs()</code> function, the original label from the data will still appear.</p>
<p>Also, if you want to remove the legend, you can do so by adjusting the <code>theme()</code> function.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="data-visualization.html#cb171-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb171-2"><a href="data-visualization.html#cb171-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score,<span class="at">y =</span> rating,  <span class="at">fill =</span> rating, <span class="at">color =</span> rating)) <span class="sc">+</span></span>
<span id="cb171-3"><a href="data-visualization.html#cb171-3" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb171-4"><a href="data-visualization.html#cb171-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb171-5"><a href="data-visualization.html#cb171-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;hide&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-217-1.png" width="672" /></p>
</div>
<div id="colors" class="section level3 hasAnchor" number="8.8.2">
<h3><span class="header-section-number">8.8.2</span> colors<a href="data-visualization.html#colors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s demonstrate how to change colors in a graph with the <code>lego_sample</code> dataset!</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="data-visualization.html#cb172-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb172-2"><a href="data-visualization.html#cb172-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb172-3"><a href="data-visualization.html#cb172-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> price, <span class="at">fill =</span> <span class="fu">as.factor</span>(minifigures))) <span class="sc">+</span></span>
<span id="cb172-4"><a href="data-visualization.html#cb172-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-218-1.png" width="672" /></p>
<p>For easier demonstration, we will focus on LEGO sets with 1 to 3 minifigures.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="data-visualization.html#cb173-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb173-2"><a href="data-visualization.html#cb173-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb173-3"><a href="data-visualization.html#cb173-3" tabindex="-1"></a>  <span class="fu">filter</span>(minifigures <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb173-4"><a href="data-visualization.html#cb173-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> price, <span class="at">fill =</span> <span class="fu">as.factor</span>(minifigures))) <span class="sc">+</span></span>
<span id="cb173-5"><a href="data-visualization.html#cb173-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-219-1.png" width="672" /></p>
<p>Now we’re all set!</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="data-visualization.html#cb174-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb174-2"><a href="data-visualization.html#cb174-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb174-3"><a href="data-visualization.html#cb174-3" tabindex="-1"></a>  <span class="fu">filter</span>(minifigures <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb174-4"><a href="data-visualization.html#cb174-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> price, <span class="at">fill =</span> <span class="fu">as.factor</span>(minifigures))) <span class="sc">+</span></span>
<span id="cb174-5"><a href="data-visualization.html#cb174-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb174-6"><a href="data-visualization.html#cb174-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;pink&quot;</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-220-1.png" width="672" /></p>
<p>It’s as simple as that! Also, note that you only need to specify each color once. For instance, although the colors <code>"darkblue"</code>, <code>"yellow"</code>, and <code>"pink"</code> appear twice in the graph, we only need to type them once in stead of using <code>values = c("darkblue", "yellow", "pink", "darkblue", "yellow", "pink")</code>.</p>
<p>If you don’t want to use default colors but don’t feel like manually selecting distinct colors each time, you can use pre-existing color palettes in RStudio.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="data-visualization.html#cb175-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;viridis&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="data-visualization.html#cb176-1" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code></pre></div>
<p>You can also add outlines to the bars in the chart to make them pop up more.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="data-visualization.html#cb177-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb177-2"><a href="data-visualization.html#cb177-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb177-3"><a href="data-visualization.html#cb177-3" tabindex="-1"></a>  <span class="fu">filter</span>(minifigures <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb177-4"><a href="data-visualization.html#cb177-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> price, <span class="at">fill =</span> <span class="fu">as.factor</span>(minifigures))) <span class="sc">+</span></span>
<span id="cb177-5"><a href="data-visualization.html#cb177-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb177-6"><a href="data-visualization.html#cb177-6" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() </span></code></pre></div>
<p><img src="figures/unnamed-chunk-223-1.png" width="672" /></p>
<p>Note that we use <code>scale_fill_viridis_d()</code> here. If you’re using <code>color =</code> instead of <code>fill =</code>, remember to switch to <code>scale_color_viridis_d()</code>.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="data-visualization.html#cb178-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb178-2"><a href="data-visualization.html#cb178-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb178-3"><a href="data-visualization.html#cb178-3" tabindex="-1"></a>  <span class="fu">filter</span>(minifigures <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb178-4"><a href="data-visualization.html#cb178-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> price, <span class="at">color =</span> <span class="fu">as.factor</span>(minifigures))) <span class="sc">+</span></span>
<span id="cb178-5"><a href="data-visualization.html#cb178-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="data-visualization.html#cb178-6" tabindex="-1"></a>    <span class="fu">scale_color_viridis_d</span>() </span></code></pre></div>
<p><img src="figures/unnamed-chunk-224-1.png" width="672" /></p>
<p><strong>My frequently used color palettes</strong></p>
<ol style="list-style-type: decimal">
<li><p>Down to Earth</p>
<p><img src="figures/unnamed-chunk-225-1.png" width="672" /></p></li>
<li><p>Reykjavik Winter</p>
<p><img src="figures/unnamed-chunk-226-1.png" width="672" /></p></li>
<li><p>Barcelona Sun</p>
<p><img src="figures/unnamed-chunk-227-1.png" width="672" /></p></li>
<li><p>Brúarfoss</p>
<p><img src="figures/unnamed-chunk-228-1.png" width="672" /></p></li>
</ol>
</div>
<div id="scales" class="section level3 hasAnchor" number="8.8.3">
<h3><span class="header-section-number">8.8.3</span> scales<a href="data-visualization.html#scales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, let’s look at some data from <code>heroes2</code> dataset.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="data-visualization.html#cb179-1" tabindex="-1"></a>heroes2 <span class="sc">|&gt;</span></span>
<span id="cb179-2"><a href="data-visualization.html#cb179-2" tabindex="-1"></a>  <span class="fu">filter</span>(Intelligence <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;good&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb179-3"><a href="data-visualization.html#cb179-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> Strength)) <span class="sc">+</span></span>
<span id="cb179-4"><a href="data-visualization.html#cb179-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb179-5"><a href="data-visualization.html#cb179-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">width =</span> .<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb179-6"><a href="data-visualization.html#cb179-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Intelligence <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-229-1.png" width="672" /></p>
<p>Take a quick glance at the chart. It seems like the <code>good</code> intelligence group has higher strength than the <code>high</code> intelligence group as the bar is higher.</p>
<p>But is that really the case?</p>
<p>Take a closer look at the two bar charts. The y-axis scales are different from one graph to another.</p>
<p>To verify, let’s calculate the average strength for both groups.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="data-visualization.html#cb180-1" tabindex="-1"></a>heroes2 <span class="sc">|&gt;</span></span>
<span id="cb180-2"><a href="data-visualization.html#cb180-2" tabindex="-1"></a>  <span class="fu">filter</span>(Intelligence <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;good&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb180-3"><a href="data-visualization.html#cb180-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Intelligence, Gender) <span class="sc">|&gt;</span></span>
<span id="cb180-4"><a href="data-visualization.html#cb180-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_strength =</span> <span class="fu">mean</span>(Strength))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
## # Groups:   Intelligence [2]
##   Intelligence Gender mean_strength
##   &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;
## 1 good         F               34  
## 2 good         M               45.4
## 3 high         F               55  
## 4 high         M               57.0</code></pre>
<p>We can see from the results that in the <code>good</code> intelligence group, the average strength of both genders is actually lower than in the <code>high</code> intelligence group. However, without paying attention to the y-axis, we might have gotten the wrong impression that the <code>good</code> intelligence group had higher strength than the <code>high</code> intelligence group.</p>
<p>To fix this issue, we can manually adjust the scale using <code>coord_cartesian()</code>. You can choose to remove <code>scales = "free"</code> or leave it there. Since the code is applied in layers, if you add the manual scale after specifying <code>scales = "free"</code>, the graph will be unaffected.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="data-visualization.html#cb182-1" tabindex="-1"></a>heroes2 <span class="sc">|&gt;</span></span>
<span id="cb182-2"><a href="data-visualization.html#cb182-2" tabindex="-1"></a>  <span class="fu">filter</span>(Intelligence <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;good&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb182-3"><a href="data-visualization.html#cb182-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> Strength)) <span class="sc">+</span></span>
<span id="cb182-4"><a href="data-visualization.html#cb182-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">7</span>, <span class="at">fill =</span> <span class="st">&quot;#BDD5EA&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-5"><a href="data-visualization.html#cb182-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">width =</span> .<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb182-6"><a href="data-visualization.html#cb182-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Intelligence <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-7"><a href="data-visualization.html#cb182-7" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-231-1.png" width="672" /></p>
<p>After setting the same scale for all graphs, it becomes much easier to compare them and observe relationships between variables.</p>
<p>You can modify the <code>ylim()</code> values based on your data.</p>
</div>
<div id="themes" class="section level3 hasAnchor" number="8.8.4">
<h3><span class="header-section-number">8.8.4</span> themes<a href="data-visualization.html#themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>theme()</code> function allows you to change the overall appearance of your graph. Some commonly used themes are <code>theme_classic()</code>, <code>theme_light()</code>, <code>theme_test()</code>, and the default <code>theme_gray()</code>.</p>
</div>
<div id="significance-levels" class="section level3 hasAnchor" number="8.8.5">
<h3><span class="header-section-number">8.8.5</span> significance levels<a href="data-visualization.html#significance-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To be honest, before I discovered this function, I always pasted my graphs into PowerPoint and then used bars and star signs to manually add the significance levels to the graphs. It was super tedious and difficult, as I often accidentally moved the graphs easily.</p>
<p>Not to mention, I frequently forgot to leave enough space for the significance levels to be displayed on the graph, which required me to go back to the code and use <code>coord_cartesian()</code> to change the scale again and again.</p>
<p>To make matters worse, it is really hard to get the precise position, as I would have to draw multiple grid lines to help me align everything.</p>
<p>Now, these problems will vanish into thin air! I present to you the power of <code>geom_signif()</code>, which allows you to easily add significance levels (or anything else you want) to your graphs!</p>
<p>This life-changing function is from <code>ggsignif</code> package. Therefore, install and library the package first.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="data-visualization.html#cb183-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggsignif&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="data-visualization.html#cb184-1" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span></code></pre></div>
<p>Let’s start by simply take a graph we already drew in the previous parts.</p>
<p>Here, we place the graph in a separate plot called <code>lego_graph</code>. While you can continue adding significance levels after the plot, I prefer to separate both functions for easier readability.</p>
<p><strong>example 1: lego_sample</strong></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="data-visualization.html#cb185-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb185-2"><a href="data-visualization.html#cb185-2" tabindex="-1"></a>  <span class="fu">filter</span>(packaging <span class="sc">==</span> <span class="st">&quot;Box&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb185-3"><a href="data-visualization.html#cb185-3" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb185-4"><a href="data-visualization.html#cb185-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theme, <span class="at">y =</span> price, <span class="at">fill =</span> theme)) <span class="sc">+</span></span>
<span id="cb185-5"><a href="data-visualization.html#cb185-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb185-6"><a href="data-visualization.html#cb185-6" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">12</span>) <span class="ot">-&gt;</span> lego_graph</span>
<span id="cb185-7"><a href="data-visualization.html#cb185-7" tabindex="-1"></a>lego_graph</span></code></pre></div>
<p><img src="figures/unnamed-chunk-234-1.png" width="672" /></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="data-visualization.html#cb186-1" tabindex="-1"></a>lego_graph<span class="sc">+</span></span>
<span id="cb186-2"><a href="data-visualization.html#cb186-2" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample, </span>
<span id="cb186-3"><a href="data-visualization.html#cb186-3" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;DUPLO®&quot;</span>,<span class="st">&quot;Friends&quot;</span>)))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-235-1.png" width="672" /></p>
<p>If I want to move the bar lower, I can change its position using <code>y_position =</code>.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="data-visualization.html#cb187-1" tabindex="-1"></a>lego_graph<span class="sc">+</span></span>
<span id="cb187-2"><a href="data-visualization.html#cb187-2" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample, </span>
<span id="cb187-3"><a href="data-visualization.html#cb187-3" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;DUPLO®&quot;</span>,<span class="st">&quot;Friends&quot;</span>)),</span>
<span id="cb187-4"><a href="data-visualization.html#cb187-4" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">90</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-236-1.png" width="672" /></p>
<p>You can adjust the number by your need. Trials and errors are required in order to find the perfect position.</p>
<p>Let’s say we want to add another significance level.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="data-visualization.html#cb188-1" tabindex="-1"></a>lego_graph <span class="sc">+</span></span>
<span id="cb188-2"><a href="data-visualization.html#cb188-2" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample, </span>
<span id="cb188-3"><a href="data-visualization.html#cb188-3" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;DUPLO®&quot;</span>,<span class="st">&quot;Friends&quot;</span>)),</span>
<span id="cb188-4"><a href="data-visualization.html#cb188-4" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb188-5"><a href="data-visualization.html#cb188-5" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample,</span>
<span id="cb188-6"><a href="data-visualization.html#cb188-6" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Friends&quot;</span>, <span class="st">&quot;City&quot;</span>)),</span>
<span id="cb188-7"><a href="data-visualization.html#cb188-7" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">73</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-237-1.png" width="672" /></p>
<p>Note that it is highly advised to change the <code>y_position</code> between two bars, so that they don’t overlap and hinder the information.</p>
<p>If today you don’t want the numbers, just want “not sig” or other words you’d like, you can also modify that by using <code>annotations</code>.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="data-visualization.html#cb189-1" tabindex="-1"></a>lego_graph <span class="sc">+</span></span>
<span id="cb189-2"><a href="data-visualization.html#cb189-2" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample, </span>
<span id="cb189-3"><a href="data-visualization.html#cb189-3" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;DUPLO®&quot;</span>,<span class="st">&quot;Friends&quot;</span>)),</span>
<span id="cb189-4"><a href="data-visualization.html#cb189-4" tabindex="-1"></a>              <span class="at">map_signif_level =</span> <span class="cn">TRUE</span>, <span class="at">annotations =</span> <span class="st">&quot;not sig. :(&quot;</span>,</span>
<span id="cb189-5"><a href="data-visualization.html#cb189-5" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb189-6"><a href="data-visualization.html#cb189-6" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample,</span>
<span id="cb189-7"><a href="data-visualization.html#cb189-7" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Friends&quot;</span>, <span class="st">&quot;City&quot;</span>)),</span>
<span id="cb189-8"><a href="data-visualization.html#cb189-8" tabindex="-1"></a>              <span class="at">map_signif_level =</span> <span class="cn">TRUE</span>, <span class="at">annotations =</span> <span class="st">&quot;not sig. :P&quot;</span>,</span>
<span id="cb189-9"><a href="data-visualization.html#cb189-9" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">73</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-238-1.png" width="672" /></p>
<p>If your data is not significant, and you just want to add “NS”, then you could just remove the <code>annotations</code> part and leave the <code>map_signif_level = TRUE</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="data-visualization.html#cb190-1" tabindex="-1"></a>lego_graph <span class="sc">+</span></span>
<span id="cb190-2"><a href="data-visualization.html#cb190-2" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> lego_sample, </span>
<span id="cb190-3"><a href="data-visualization.html#cb190-3" tabindex="-1"></a>              <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;DUPLO®&quot;</span>,<span class="st">&quot;Friends&quot;</span>)),</span>
<span id="cb190-4"><a href="data-visualization.html#cb190-4" tabindex="-1"></a>              <span class="at">map_signif_level =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-5"><a href="data-visualization.html#cb190-5" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">90</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-239-1.png" width="672" /></p>
<p>These labelling methods applies to other kinds of graphs as well.</p>
<p>However, if we type <code>geom_signif</code> into the <strong>Help</strong> panel on the right, we can see that the default they are using is <strong>wilcox.test</strong> instead of <strong>t.test</strong>. If, you are like me, used t.test more often, then we need to manually change the test type.</p>
<p>Take the <code>heroes2</code> dataset for example.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="data-visualization.html#cb191-1" tabindex="-1"></a>heroes2 <span class="sc">|&gt;</span></span>
<span id="cb191-2"><a href="data-visualization.html#cb191-2" tabindex="-1"></a>  <span class="fu">filter</span>(Publisher <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Marvel Comics&quot;</span>, <span class="st">&quot;DC Comics&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb191-3"><a href="data-visualization.html#cb191-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> Strength, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb191-4"><a href="data-visualization.html#cb191-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">6</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb191-5"><a href="data-visualization.html#cb191-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb191-6"><a href="data-visualization.html#cb191-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Publisher) <span class="sc">+</span></span>
<span id="cb191-7"><a href="data-visualization.html#cb191-7" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>)),</span>
<span id="cb191-8"><a href="data-visualization.html#cb191-8" tabindex="-1"></a>              <span class="at">map_signif_level =</span> T,</span>
<span id="cb191-9"><a href="data-visualization.html#cb191-9" tabindex="-1"></a>              <span class="at">test =</span> <span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb191-10"><a href="data-visualization.html#cb191-10" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb191-11"><a href="data-visualization.html#cb191-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-240-1.png" width="672" /></p>
<p>As you can see, by simply adding <code>test = "t.test"</code>, we can achieve our goal.</p>
<p>What if you are dealing with multiple levels of data instead of just two? The only thing you need to do is to add more layers of <code>geom_signif()</code> into the plot.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="data-visualization.html#cb192-1" tabindex="-1"></a>lego_sample <span class="sc">|&gt;</span></span>
<span id="cb192-2"><a href="data-visualization.html#cb192-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theme, <span class="at">y =</span> price, <span class="at">fill =</span> theme)) <span class="sc">+</span></span>
<span id="cb192-3"><a href="data-visualization.html#cb192-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">6</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb192-4"><a href="data-visualization.html#cb192-4" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">8</span>), <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb192-5"><a href="data-visualization.html#cb192-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year) <span class="sc">+</span></span>
<span id="cb192-6"><a href="data-visualization.html#cb192-6" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;DUPLO®&quot;</span>, <span class="st">&quot;Friends&quot;</span>)),</span>
<span id="cb192-7"><a href="data-visualization.html#cb192-7" tabindex="-1"></a>              <span class="at">map_signif_level =</span> T,</span>
<span id="cb192-8"><a href="data-visualization.html#cb192-8" tabindex="-1"></a>              <span class="at">test =</span> <span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb192-9"><a href="data-visualization.html#cb192-9" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">80</span>) <span class="sc">+</span></span>
<span id="cb192-10"><a href="data-visualization.html#cb192-10" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;City&quot;</span>, <span class="st">&quot;Friends&quot;</span>)),</span>
<span id="cb192-11"><a href="data-visualization.html#cb192-11" tabindex="-1"></a>              <span class="at">map_signif_level =</span> T,</span>
<span id="cb192-12"><a href="data-visualization.html#cb192-12" tabindex="-1"></a>              <span class="at">test =</span> <span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb192-13"><a href="data-visualization.html#cb192-13" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">65</span>) <span class="sc">+</span></span>
<span id="cb192-14"><a href="data-visualization.html#cb192-14" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;City&quot;</span>, <span class="st">&quot;DUPLO®&quot;</span>)),</span>
<span id="cb192-15"><a href="data-visualization.html#cb192-15" tabindex="-1"></a>              <span class="at">map_signif_level =</span> T,</span>
<span id="cb192-16"><a href="data-visualization.html#cb192-16" tabindex="-1"></a>              <span class="at">test =</span> <span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb192-17"><a href="data-visualization.html#cb192-17" tabindex="-1"></a>              <span class="at">y_position =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb192-18"><a href="data-visualization.html#cb192-18" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-241-1.png" width="672" /></p>
<p><strong>example 2: movies</strong></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="data-visualization.html#cb193-1" tabindex="-1"></a>movies <span class="sc">|&gt;</span></span>
<span id="cb193-2"><a href="data-visualization.html#cb193-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> rating)) <span class="sc">+</span></span>
<span id="cb193-3"><a href="data-visualization.html#cb193-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="ot">-&gt;</span> movie_graph</span>
<span id="cb193-4"><a href="data-visualization.html#cb193-4" tabindex="-1"></a>movie_graph</span></code></pre></div>
<p><img src="figures/unnamed-chunk-242-1.png" width="672" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="data-visualization.html#cb194-1" tabindex="-1"></a>movie_graph <span class="sc">+</span> </span>
<span id="cb194-2"><a href="data-visualization.html#cb194-2" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> movies, <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;PG&quot;</span>)))</span></code></pre></div>
<p><img src="figures/unnamed-chunk-243-1.png" width="672" /></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-export.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cocoyamo/R_tutorials/edit/gh-pages/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"fig_caption": true,
"theme": "simplex",
"toc_depth": 3,
"toc_float": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
